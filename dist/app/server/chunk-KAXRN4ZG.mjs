import './polyfills.server.mjs';
import{Ha as u,K as h,vb as r}from"./chunk-6OJQON2Z.mjs";import{a as n,b as c}from"./chunk-VVCT4QZE.mjs";var m="cart_items",v=(()=>{class i{constructor(){this.items=u(this.loadFromStorage()),this.cartItems=this.items.asReadonly(),this.itemCount=r(()=>this.items().reduce((t,e)=>t+e.quantity,0)),this.subtotal=r(()=>this.items().reduce((t,e)=>t+e.price_ars*e.quantity,0)),this.isEmpty=r(()=>this.items().length===0)}add(t){let e=this.items(),s=e.find(a=>a.variantId===t.variantId);if(s){let a=s.quantity+t.quantity;if(a>s.stock)return;this.items.set(e.map(o=>o.variantId===t.variantId?c(n({},o),{quantity:a}):o))}else this.items.set([...e,t]);this.saveToStorage()}remove(t){this.items.set(this.items().filter(e=>e.variantId!==t)),this.saveToStorage()}updateQuantity(t,e){if(e<=0){this.remove(t);return}this.items.set(this.items().map(s=>s.variantId===t?c(n({},s),{quantity:e}):s)),this.saveToStorage()}clear(){this.items.set([]),localStorage.removeItem(m)}saveToStorage(){localStorage.setItem(m,JSON.stringify(this.items()))}loadFromStorage(){try{let t=localStorage.getItem(m);return t?JSON.parse(t):[]}catch{return[]}}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{v as a};
